# https://taskfile.dev

version: "3"

dotenv: [".env"]

tasks:
  setup:
    desc: Install dependencies
    dir: "{{.TASKFILE_DIR}}"
    sources:
      - .rtx.toml
      - package.json
      - pnpm-lock.yaml
      - "**/package.json"
    cmds:
      - rtx install 2> /dev/null || true
      - pnpm install

  dev:
    desc: Start the development server
    deps: [setup]
    cmds:
      - npx astro dev

  build:
    desc: Build the project
    cmds:
      - npx astro build

  cms:
    desc: Start the CMS
    dir: ./apps/cms
    cmds:
      - docker-compose -f docker-compose.local.yml up
